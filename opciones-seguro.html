<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Opciones de Seguro - GNP</title>
    <link rel="stylesheet" href="assets/css/main.css">
    <link id="dynamic-theme-style-link" rel="stylesheet" href="assets/css/theme-veler-blue_2.css">
    <link rel="icon" href="assets/img/V_icon.png" type="image/x-icon">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="components/chatbot_seguros.css">
    
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            background-color: var(--bg-color);
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            color: var(--text-color-primary);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .opciones-main-container {
            width: 100%;
            height: auto;
            max-width: 960px;
            margin-top: 40px;
            margin-bottom: 40px;
        }

        .opciones-header {
            font-family: SF Pro Display Light;
            text-align: center;
            margin-bottom: 40px;
        }

        .opciones-header h1 {
            color: var(--accent-color);
            margin-bottom: 10px;
            font-size: 2em;
            font-weight: 700;
        }

        .opciones-header .subtitulo-opciones {
            font-family: SF Pro Display Light;
            color: var(--text-color-secondary);
            font-size: 1.1em;
            font-weight: 300;
        }

        .card-options-div {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: stretch;
            padding: 15px;
            gap: 20px;
        }

        .tarjeta-opcion {
            background-color: var(--bg-container);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(var(--bg-color-rgb, 0,0,0),0.05);
            display: flex;
            flex-direction: column;
            flex: 1 1;
            width: 40%;
            height: auto;
            max-width: 40%;
            transition: transform 0.25s cubic-bezier(0.25, 0.8, 0.25, 1),
                        box-shadow 0.25s cubic-bezier(0.25, 0.8, 0.25, 1),
                        border-color 0.25s ease-in-out;
        }

        @media (max-width: 530px) {
            .tarjeta-opcion {
                max-width: 100%;
            }
        }

        .tarjeta-opcion:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 10px 25px rgba(var(--accent-color-rgb, 0,0,0), 0.15);
            border-color: var(--accent-color);
        }

        .tarjeta-opcion h2 {
            color: var(--accent-color);
            font-family: SF Pro Display Light;
            font-size: 1.4em;
            margin-top: 0;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 10px;
        }

        .tarjeta-opcion .precio-estimado {
            font-size: 1.8em;
            font-weight: 700;
            color: var(--text-color-primary);
            margin-bottom: 15px;
        }
        .tarjeta-opcion .precio-estimado span {
            font-size: 0.6em;
            font-weight: 300;
            color: var(--text-color-secondary);
        }

        .tarjeta-opcion ul {
            list-style: none;
            padding: 0;
            margin: 0 0 20px 0;
            text-align: left;
            font-family: SF Pro Display Light;
            flex-grow: 1;
        }
        .tarjeta-opcion ul li {
            margin-bottom: 8px;
            font-size: 0.9em;
            color: var(--text-color-secondary);
            display: flex;
            align-items: center;
        }
        .tarjeta-opcion ul li .material-symbols-outlined {
            font-size: 1.1em;
            margin-right: 8px;
            color: var(--accent-color);
        }

        a {
            text-decoration: none;
            color: var(--link-color);
        }

        .btn-seleccionar-plan {
            background-color: var(--button-primary-bg);
            color: var(--button-primary-text);
            padding: 10px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-family: SF Pro Display Light;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: background-color 0.3s ease, opacity 0.3s ease, transform 0.1s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            margin-top: auto;
        }
        .btn-seleccionar-plan:hover {
            opacity: 0.85;
        }
         .btn-seleccionar-plan:active {
             transform: scale(0.98);
        }

        .theme-controls-opciones {
            position: fixed; top: 20px; right: 20px; z-index: 1050; 
            display: flex; align-items: center; gap: 15px;
        }
        .theme-controls-opciones #theme-selector-opciones {
            padding: 5px 10px; border-radius: 4px; border: 1px solid var(--border);
            background-color: var(--input-bg); color: var(--input-text-color);
            cursor: pointer; font-size: 0.85em; min-width: 120px; height: 28px;
            box-sizing: border-box; transition: border-color 0.3s ease, background-color 0.3s ease, color 0.3s ease;
        }
        .theme-controls-opciones #theme-selector-opciones:focus {
            outline: none; border-color: var(--accent-color); box-shadow: 0 0 0 2px rgba(var(--accent-color-rgb), 0.2);
        }
        .theme-controls-opciones .theme-switch {
            position: relative; display: block; width: 50px; height: 25px; cursor: pointer;
            background-color: var(--input-bg); border: 1px solid var(--accent-color);
            border-radius: 25px; text-indent: -9999px; transition: background-color 0.3s ease;
        }
        .theme-controls-opciones .theme-switch input[type="checkbox"] { opacity: 0; width: 0; height: 0; position: absolute; }
        .theme-controls-opciones .theme-switch .slider {
            position: absolute; top: 1px; left: 1px; width: 21px; height: 21px;
            background-color: var(--accent-color); border-radius: 50%;
            transition: transform 0.3s ease, background-color 0.3s ease; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        .theme-controls-opciones .slider .icon {
            line-height: 1; transition: opacity 0.3s ease, transform 0.3s ease; color: var(--button-primary-text);
        }
        .theme-controls-opciones .slider .icon.material-symbols-outlined {
             font-size: 16px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
        }
        .theme-controls-opciones .slider .sun { opacity: 0; transform: translate(-50%, -50%) scale(0) rotate(-90deg); }
        .theme-controls-opciones .slider .moon { opacity: 1; transform: translate(-50%, -50%) scale(1) rotate(0deg); }
        .theme-controls-opciones .theme-switch input:checked + .slider { transform: translateX(25px); }
        .theme-controls-opciones .theme-switch input:checked + .slider .sun { opacity: 1; transform: translate(-50%, -50%) scale(1) rotate(0deg); }
        .theme-controls-opciones .theme-switch input:checked + .slider .moon { opacity: 0; transform: translate(-50%, -50%) scale(0) rotate(90deg); }

        /* --- ESTILOS PARA EL NUEVO MODAL --- */
        .modal-wrapper {
            position: fixed;
            inset: 0;
            z-index: 1100; /* Por encima del chatbot */
            background-color: rgba(var(--bg-color-rgb, 0,0,0), 0.6);
            backdrop-filter: blur(4px);
            display: none; /* Cambiar a flex para mostrar */
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: var(--bg-container);
            padding: 30px 35px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 450px;
            text-align: center;
            border: 1px solid var(--border);
            position: relative;
        }
        .modal-content .close-button {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 28px;
            font-weight: bold;
            color: var(--text-color-secondary);
            cursor: pointer;
            line-height: 1;
        }
        .modal-content .close-button:hover {
            color: var(--text-color-primary);
        }
        .modal-content h2 {
            color: var(--accent-color);
            margin-top: 0;
            margin-bottom: 10px;
        }
        .form-modal p {
            font-weight: 500;
            color: var(--text-color-secondary);
            margin-top: 25px;
            margin-bottom: 15px;
        }
        .form-modal .radio-group {
            display: block;
            text-align: left;
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
        }
        .form-modal .radio-group label {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        .form-modal .radio-group input[type="radio"] {
            margin-right: 10px;
            width: 1.2em;
            height: 1.2em;
            accent-color: var(--accent-color);
        }
        .btn-full-width {
            width: 100%;
            margin-top: 25px;
            padding-top: 12px;
            padding-bottom: 12px;
        }

    </style>
</head>
<body>
    <div class="theme-controls-opciones">
        <select id="theme-selector-opciones" title="Seleccionar Tema de Color"></select>
        <label class="theme-switch" for="theme-checkbox-opciones">
            <input type="checkbox" id="theme-checkbox-opciones" />
            <div class="slider round">
                <span class="icon material-symbols-outlined sun">light_mode</span>
                <span class="icon material-symbols-outlined moon">dark_mode</span>
            </div>
        </label>
    </div>

    <div class="opciones-main-container">
        <div class="opciones-header">
            <img id="logo-main-opciones" src="assets/img/veler_light.png" alt="Logo Veler Technologies" style="max-height: 70px; margin-bottom: 20px;">
            <h1>Tus Opciones de Seguro</h1>
            <p class="subtitulo-opciones">Hemos preparado estas alternativas basadas en tus datos. <br>Selecciona una para ver todos los detalles y completar tu solicitud.</p>
        </div>

        <div class="card-options-div">
            <div class="tarjeta-opcion">
                <h2>Plan Esencial</h2>
                <div class="precio-estimado">$1,250 <span>MXN/mes</span></div>
                <ul>
                    <li><span class="material-symbols-outlined">local_hospital</span> Cobertura Nacional</li>
                    <li><span class="material-symbols-outlined">paid</span> Suma Asegurada: $2,000,000</li>
                    <li><span class="material-symbols-outlined">receipt_long</span> Deducible: $15,000</li>
                    <li><span class="material-symbols-outlined">percent</span> Coaseguro: 10%</li>
                    <li>
                        <span class="material-symbols-outlined">verified_user</span>
                        <span>Cobertura
                        <a href="https://www.velertech.com/mx/vhealth"> vHealth </a>
                        Básica</span>
                    </li>
                </ul>
                <button type="button" class="btn-seleccionar-plan" data-plan-nombre="Plan Esencial">
                    Seleccionar Plan
                </button>
            </div>

            <div class="tarjeta-opcion">
                <h2>Plan Comfort</h2>
                <div class="precio-estimado">$1,800 <span>MXN/mes</span></div>
                <ul>
                    <li><span class="material-symbols-outlined">local_hospital</span> Cobertura Nacional Amplia</li>
                    <li><span class="material-symbols-outlined">paid</span> Suma Asegurada: $5,000,000</li>
                    <li><span class="material-symbols-outlined">receipt_long</span> Deducible: $10,000</li>
                    <li><span class="material-symbols-outlined">percent</span> Coaseguro: 10% (Tope $50,000)</li>
                    <li><span class="material-symbols-outlined">emergency_home</span> Emergencia en el extranjero.</li>
                    <li>
                        <span class="material-symbols-outlined">verified_user</span>
                        <span>Cobertura
                        <a href="https://www.velertech.com/mx/vhealth"> vHealth </a>
                        Media</span>
                    </li>
                </ul>
                <button type="button" class="btn-seleccionar-plan" data-plan-nombre="Plan Confort">
                    Seleccionar Plan
                </button>
            </div>

            <div class="tarjeta-opcion">
                <h2>Plan Premium Global</h2>
                <div class="precio-estimado">$3,500 <span>MXN/mes</span></div>
                <ul>
                    <li><span class="material-symbols-outlined">flight_takeoff</span> Cobertura Internacional</li>
                    <li><span class="material-symbols-outlined">paid</span> Suma Asegurada: $10,000,000 USD</li>
                    <li><span class="material-symbols-outlined">receipt_long</span> Deducible: $500 USD</li>
                    <li><span class="material-symbols-outlined">percent</span> Coaseguro: 0% en el extranjero (red)</li>
                    <li><span class="material-symbols-outlined">health_and_safety</span> Todos los beneficios premium.</li>
                    <li>
                        <span class="material-symbols-outlined">verified_user</span>
                        <span>Cobertura
                        <a href="https://www.velertech.com/mx/vhealth"> vHealth </a>
                        Premium</span>
                    </li>
                </ul>
                <button type="button" class="btn-seleccionar-plan" data-plan-nombre="Plan Premium Global">
                    Seleccionar Plan
                </button>
            </div>
        </div>
    </div>

    <button id="chatbot-gnp-toggle-button" class="chatbot-gnp-toggle-button">
        <span class="material-symbols-outlined icon-open">support_agent</span>
        <span class="material-symbols-outlined icon-close" style="display:none;">close</span>
    </button>
    
    <div id="chatbotGNPContainer" class="chatbot-gnp-container" style="display: none;">
        </div>


    <div id="transicionModal" class="modal-wrapper" style="display: none;">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            
            <h2>Estás a un paso de iniciar</h2>
            
            <p>Has seleccionado el plan: <strong id="modalPlanNombre"></strong>.</p>
            
            <form id="formTipoSolicitante" class="form-modal">
                <p><strong>Esta solicitud es para:</strong></p>
                
                <div class="radio-group">
                    <label for="tipoPersona">
                        <input type="radio" id="tipoPersona" name="tipo_solicitud" value="persona" checked>
                        Una Persona
                    </label>
                </div>
                
                <div class="radio-group">
                    <label for="tipoEmpresa">
                        <input type="radio" id="tipoEmpresa" name="tipo_solicitud" value="empresa">
                        Una Empresa
                    </label>
                </div>
    
                <div class="radio-group">
                    <label for="tipoGrupo">
                        <input type="radio" id="tipoGrupo" name="tipo_solicitud" value="grupo">
                        Un Grupo
                    </label>
                </div>
                
                <button type="submit" class="btn-seleccionar-plan btn-full-width" id="btnIniciarSolicitud">
                    Iniciar Solicitud
                </button>
            </form>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- LÓGICA DE TEMAS (SIN CAMBIOS) ---
            const themeSwitchOps = document.getElementById('theme-checkbox-opciones');
            const themeSelectorOps = document.getElementById('theme-selector-opciones');
            const htmlEl = document.documentElement;
            const dynamicThemeLink = document.getElementById('dynamic-theme-style-link');

            const CONFIG_OPS = {
                THEME_STORAGE_KEY: 'theme_mode',
                AVAILABLE_THEMES: [
            { name: "Veler Blue", file: "assets/css/theme-veler-blue.css" },
            { name: "Teal Green", file: "assets/css/theme-teal-green.css" },
            { name: "Slate Mauve", file: "assets/css/theme-slate-mauve.css" },
            { name: "Pink", file: "assets/css/theme-pink.css" },
            { name: "Gold Teal", file: "assets/css/theme-gold-teal.css" },
            { name: "Gold", file: "assets/css/theme-gold.css"},
            { name: "Red Dark", file: "assets/css/theme-red-dark.css"},
            { name: "GNP Default", file: "assets/css/theme-default.css" }
                ],
                DEFAULT_THEME_FILE: "assets/css/theme-default.css",
                SELECTED_THEME_FILE_KEY: 'selected_theme_file'
            };

            function applyThemeModeOps(mode) {
                htmlEl.classList.toggle('light-theme', mode === 'light');
                const logoMain = document.getElementById('logo-main-opciones');
                if (logoMain) {
                    logoMain.src = mode === 'light' ? 'assets/img/VELER_LIGHT.png' : 'assets/img/VELER_DARK.png';
                }
            }

            function _initThemeSelectorDOMOps() {
                if (themeSelectorOps) {
                    CONFIG_OPS.AVAILABLE_THEMES.forEach(theme => {
                        const option = document.createElement('option');
                        option.value = theme.file;
                        option.textContent = theme.name;
                        themeSelectorOps.appendChild(option);
                    });
                    const savedThemeFile = localStorage.getItem(CONFIG_OPS.SELECTED_THEME_FILE_KEY) || CONFIG_OPS.DEFAULT_THEME_FILE;
                    const isValidSavedTheme = CONFIG_OPS.AVAILABLE_THEMES.some(theme => theme.file === savedThemeFile);
                    const themeFileToLoad = isValidSavedTheme ? savedThemeFile : CONFIG_OPS.DEFAULT_THEME_FILE;

                    if (dynamicThemeLink) dynamicThemeLink.href = themeFileToLoad;
                    themeSelectorOps.value = themeFileToLoad;

                    themeSelectorOps.addEventListener('change', function() {
                        if(dynamicThemeLink) dynamicThemeLink.href = this.value;
                        localStorage.setItem(CONFIG_OPS.SELECTED_THEME_FILE_KEY, this.value);
                    });
                }
            }

            function _initCurrentThemeModeOps() {
                const savedMode = localStorage.getItem(CONFIG_OPS.THEME_STORAGE_KEY) || 'dark';
                applyThemeModeOps(savedMode);
                if (themeSwitchOps) themeSwitchOps.checked = (savedMode === 'light');
            }

            _initThemeSelectorDOMOps();
            _initCurrentThemeModeOps();

            if (themeSwitchOps) {
                themeSwitchOps.addEventListener('change', function() {
                    const mode = this.checked ? 'light' : 'dark';
                    applyThemeModeOps(mode);
                    localStorage.setItem(CONFIG_OPS.THEME_STORAGE_KEY, mode);
                });
            }

            // --- FIN DE LÓGICA DE TEMAS ---


            // --- LÓGICA DEL MODAL DE TRANSICIÓN (ACTUALIZADA) ---

            const transicionModal = document.getElementById('transicionModal');
            const cerrarModalBtn = transicionModal.querySelector('.close-button');
            const modalPlanNombre = document.getElementById('modalPlanNombre');
            const formTipoSolicitante = document.getElementById('formTipoSolicitante');
            const botonesSeleccionarPlan = document.querySelectorAll('.btn-seleccionar-plan');

            const abrirModal = (nombrePlan) => {
                modalPlanNombre.textContent = nombrePlan;
                transicionModal.style.display = 'flex';
            };

            const cerrarModal = () => {
                transicionModal.style.display = 'none';
            };

            botonesSeleccionarPlan.forEach(boton => {
                boton.addEventListener('click', () => {
                    const nombrePlan = boton.dataset.planNombre;
                    abrirModal(nombrePlan);
                });
            });

            cerrarModalBtn.addEventListener('click', cerrarModal);

            transicionModal.addEventListener('click', (event) => {
                if (event.target === transicionModal) {
                    cerrarModal();
                }
            });

            // --- INICIO DE LA MODIFICACIÓN ---
            // Manejar el envío del formulario dentro del modal
            formTipoSolicitante.addEventListener('submit', (event) => {
                event.preventDefault(); // Evita que la página se recargue

                const tipoSeleccionado = formTipoSolicitante.querySelector('input[name="tipo_solicitud"]:checked').value;
                
                // Línea de depuración que puedes usar en la consola
                console.log(`DEBUG: Tipo de solicitud seleccionado: ${tipoSeleccionado}`);

                localStorage.setItem('tipoDeSolicitud', tipoSeleccionado);
                localStorage.setItem('planSeleccionado', modalPlanNombre.textContent);

                // Variable para definir a dónde redirigir
                let urlDestino = '';

                // Lógica para asignar la URL correcta
                switch (tipoSeleccionado) {
                    case 'persona':
                        urlDestino = 'persona.html';
                        break;
                    case 'empresa':
                        urlDestino = 'empresa.html';
                        break;
                    case 'grupo':
                        urlDestino = 'grupo.html';
                        break;
                    default:
                        // Como fallback, podemos redirigir a una página principal o no hacer nada
                        console.error('Tipo de solicitud no reconocido:', tipoSeleccionado);
                        urlDestino = 'index.html'; // Opcional: redirigir a una página por defecto
                        break;
                }

                // Redirigir al usuario si se definió una URL de destino
                if (urlDestino) {
                    window.location.href = urlDestino;
                }
            });
            // --- FIN DE LA MODIFICACIÓN ---
        });
    </script>
</body>
</html>